<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>SSL 인증 파일 업로드 (Thymeleaf)</title>
  <style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #f4f7f6;
        margin: 0;
    }
    .upload-container {
        background: #ffffff;
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        text-align: center;
        width: 90%;
        max-width: 500px;
    }
    /* ... 이하 스타일은 이전과 동일 ... */
  </style>
</head>
<body>
<div class="upload-container">
  <h1>SSL 인증 파일 업로드 📜</h1>
  <p>ZeroSSL 또는 Let's Encrypt에서 받은 인증 파일을 업로드하세요.</p>

  <form id="uploadForm" enctype="multipart/form-data">
    <label for="fileInput" class="file-input-wrapper">
      <span id="fileLabel">파일을 선택하거나 여기에 드래그하세요</span>
      <div id="fileName">선택된 파일 없음</div>
    </label>
    <input type="file" id="fileInput" name="file" required>
    <button type="submit" class="upload-btn">업로드</button>
  </form>

  <div id="result"></div>
</div>
<script>
  // 자바스크립트 로직은 변경할 필요가 없습니다.
  // 여전히 '/.well-known/pki-validation' API를 호출합니다.
  const uploadForm = document.getElementById('uploadForm');
  // ... 이하 스크립트는 이전과 동일 ...
  uploadForm.addEventListener('submit', async (event) => {
      event.preventDefault();
      const formData = new FormData();
      if (uploadForm.file.files.length === 0) {
           document.getElementById('result').innerHTML = '<p class="error">파일을 선택해주세요.</p>';
           return;
      }
      formData.append('file', uploadForm.file.files[0]);
      document.getElementById('result').innerHTML = '<p>업로드 중...</p>';
      try {
          const response = await fetch('/.well-known/pki-validation', {
              method: 'POST',
              body: formData,
          });
          const data = await response.json();
          if (response.ok) {
              document.getElementById('result').innerHTML = `
                  <p class="success">${data.message}</p>
                  <p>업로드된 파일은 <a href="${data.fileUrl}" target="_blank">${data.fileUrl}</a> 에서 확인할 수 있습니다.</p>
              `;
          } else {
              document.getElementById('result').innerHTML = `<p class="error">업로드 실패: ${data.message}</p>`;
          }
      } catch (error) {
           document.getElementById('result').innerHTML = '<p class="error">업로드 중 오류가 발생했습니다.</p>';
      }
  });
</script>
</body>
</html>